CREATE DATABASE cinema_db;
USE cinema_db;

CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) UNIQUE NOT NULL,
    display_name VARCHAR(100) DEFAULT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    role ENUM('admin', 'user') DEFAULT 'user',
    phone_number VARCHAR(20) DEFAULT NULL,
    preferred_genres VARCHAR(255) DEFAULT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE movies (
    id INT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    genre VARCHAR(100),
    duration INT,
    rating VARCHAR(10),
    release_date DATE,
    poster_url VARCHAR(255),
    status ENUM('now_showing', 'coming_soon') DEFAULT 'now_showing',
    price DECIMAL(10,2) DEFAULT 0.00,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE showtimes (
    id INT PRIMARY KEY AUTO_INCREMENT,
    movie_id INT NOT NULL,
    show_date DATE NOT NULL,
    show_time TIME NOT NULL,
    total_seats INT DEFAULT 40,
    FOREIGN KEY (movie_id) REFERENCES movies(id)
);

CREATE TABLE bookings (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT,
    movie_id INT,
    showtime_id INT,
    booking_date DATE,
    show_time TIME,
    seats_booked INT,
    total_amount DECIMAL(10,2),
    payment_method ENUM('credit_card', 'debit_card', 'paypal', 'mobile_payment') DEFAULT NULL,
    payment_status ENUM('pending', 'completed', 'failed') DEFAULT 'pending',
    payment_reference VARCHAR(100) DEFAULT NULL,
    booking_status ENUM('confirmed', 'cancelled') DEFAULT 'confirmed',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (movie_id) REFERENCES movies(id),
    FOREIGN KEY (showtime_id) REFERENCES showtimes(id)
);

CREATE TABLE booked_seats (
    id INT PRIMARY KEY AUTO_INCREMENT,
    showtime_id INT,
    seat_number VARCHAR(10),
    user_id INT,
    booking_id INT,
    FOREIGN KEY (showtime_id) REFERENCES showtimes(id),
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (booking_id) REFERENCES bookings(id)
);


INSERT INTO users (username, email, password, role) VALUES 
('admin', 'admin@cinema.com', 'admin123', 'admin');

INSERT INTO movies (title, description, genre, duration, rating, release_date, poster_url, status, price) VALUES 
('How to Train Your Dragon', 'The beloved animated series returns with new adventures in the hidden world', 'Animation', 104, 'PG', '2025-06-13', 'assets/images/httyd_new.jpg', 'now_showing', 480.00),
('M3GAN 2.0', 'The killer doll returns with upgraded features and deadlier intentions', 'Horror', 102, 'PG-13', '2025-06-27', 'assets/images/megan2.jpg', 'now_showing', 520.00),
('Jurassic World: Rebirth', 'Dinosaurs once again threaten humanity in this explosive new chapter', 'Adventure', 147, 'PG-13', '2025-07-02', 'assets/images/jurassic_rebirth.jpg', 'now_showing', 550.00),
('Elio', 'A young boy accidentally becomes Earth\'s intergalactic ambassador', 'Animation', 101, 'PG', '2025-06-13', 'assets/images/elio.jpg', 'now_showing', 460.00),
('F1: The Movie', 'Experience the high-octane world of Formula 1 racing like never before', 'Action', 135, 'PG-13', '2025-06-25', 'assets/images/f1_movie.jpg', 'now_showing', 530.00),
('Superman', 'The Man of Steel returns to protect Earth from a new cosmic threat', 'Action', 142, 'PG-13', '2025-07-11', 'assets/images/superman2025.jpg', 'now_showing', 580.00),
('Sinners', 'A supernatural thriller about redemption and ancient curses', 'Horror', 118, 'R', '2025-07-03', 'assets/images/sinners.jpg', 'now_showing', 500.00),
('K-Pop Demon Hunters', 'Korean pop stars battle supernatural forces threatening Seoul', 'Action', 112, 'PG-13', '2025-06-20', 'assets/images/kpop_demons.jpg', 'now_showing', 490.00),
('28 Years Later', 'The rage virus returns in this long-awaited sequel to the zombie saga', 'Horror', 127, 'R', '2025-06-28', 'assets/images/28years_later.jpg', 'now_showing', 520.00),
('Bring Her Back', 'A father will stop at nothing to resurrect his lost daughter', 'Thriller', 105, 'PG-13', '2025-07-04', 'assets/images/bring_her_back.jpg', 'now_showing', 480.00),
('Thunderbolts', 'Marvel\'s team of antiheroes unite for an impossible mission', 'Action', 134, 'PG-13', '2025-07-25', 'assets/images/thunderbolts.jpg', 'now_showing', 570.00),
('Heads of State', 'Two world leaders must work together to prevent global catastrophe', 'Action', 124, 'PG-13', '2025-06-27', 'assets/images/heads_of_state.jpg', 'now_showing', 510.00),
('Ballerina', 'An elite assassin seeks revenge in this high-octane thriller', 'Action', 109, 'R', '2025-06-06', 'assets/images/ballerina.jpg', 'now_showing', 500.00),
('Final Destination: Bloodline', 'Death\'s design returns with more elaborate and terrifying scenarios', 'Horror', 98, 'R', '2025-05-16', 'assets/images/final_destination_bloodline.jpg', 'now_showing', 490.00),
('Minecraft Movie', 'The beloved block-building game comes to life in this family adventure', 'Adventure', 104, 'PG', '2025-04-04', 'assets/images/minecraft_movie.jpg', 'now_showing', 460.00),

-- Coming Soon Movies (10 movies)
('Spider-Man: Brand New Day', 'Peter Parker faces his greatest challenge yet in this new chapter', 'Action', 138, 'PG-13', '2025-07-24', 'assets/images/spiderman_brand_new_day.jpg', 'coming_soon', 600.00),
('The Fantastic Four: First Steps', 'Marvel\'s first family makes their MCU debut', 'Action', 126, 'PG-13', '2025-07-25', 'assets/images/fantastic_four_first_steps.jpg', 'coming_soon', 580.00),
('Godzilla x Kong: Supernova', 'The titans face their ultimate threat from the stars', 'Action', 115, 'PG-13', '2025-03-27', 'assets/images/godzilla_kong_supernova.jpg', 'coming_soon', 550.00),
('Avatar: Fire and Ash', 'Return to Pandora as Jake and Neytiri face a new elemental threat', 'Science Fiction', 190, 'PG-13', '2025-12-19', 'assets/images/avatar_fire_ash.jpg', 'coming_soon', 650.00),
('Zootopia 2', 'Judy and Nick return for another adventure in the animal metropolis', 'Animation', 108, 'PG', '2025-11-26', 'assets/images/zootopia2.jpg', 'coming_soon', 480.00),
('Frozen 3', 'Elsa and Anna embark on their most magical journey yet', 'Animation', 115, 'PG', '2025-11-24', 'assets/images/frozen3.jpg', 'coming_soon', 500.00),
('Now You See Me: Now You Don\'t', 'The Four Horsemen return with their most impossible illusion', 'Thriller', 125, 'PG-13', '2025-01-03', 'assets/images/now_you_see_me3.jpg', 'coming_soon', 520.00),
('Toy Story 5', 'Woody and Buzz face new adventures with a new generation of toys', 'Animation', 105, 'PG', '2026-06-19', 'assets/images/toy_story5.jpg', 'coming_soon', 500.00),
('Avengers: Doomsday', 'The ultimate battle for the fate of the multiverse begins', 'Action', 165, 'PG-13', '2026-05-01', 'assets/images/avengers_doomsday.jpg', 'coming_soon', 700.00),
('Spider-Man: Beyond the Spider-Verse', 'Miles Morales swings into the ultimate multiverse adventure', 'Animation', 140, 'PG', '2025-06-29', 'assets/images/spiderverse_beyond.jpg', 'coming_soon', 550.00);

INSERT INTO showtimes (movie_id, show_date, show_time) VALUES
-- July 17, 2025 showtimes
(1, '2025-07-17', '13:00:00'),
(1, '2025-07-17', '16:30:00'),
(1, '2025-07-17', '20:00:00'),
(2, '2025-07-17', '14:15:00'),
(2, '2025-07-17', '17:45:00'),
(2, '2025-07-17', '21:15:00'),
(3, '2025-07-17', '12:30:00'),
(3, '2025-07-17', '15:45:00'),
(3, '2025-07-17', '19:00:00'),
(3, '2025-07-17', '22:15:00'),
(4, '2025-07-17', '13:30:00'),
(4, '2025-07-17', '17:00:00'),
(4, '2025-07-17', '20:30:00'),
(5, '2025-07-17', '14:00:00'),
(5, '2025-07-17', '18:00:00'),
(5, '2025-07-17', '22:00:00'),
(6, '2025-07-17', '12:00:00'),
(6, '2025-07-17', '15:30:00'),
(6, '2025-07-17', '19:30:00'),
(7, '2025-07-17', '16:00:00'),
(7, '2025-07-17', '19:45:00'),
(7, '2025-07-17', '23:00:00'),
(8, '2025-07-17', '13:45:00'),
(8, '2025-07-17', '17:15:00'),
(8, '2025-07-17', '20:45:00'),
(9, '2025-07-17', '15:15:00'),
(9, '2025-07-17', '18:30:00'),
(9, '2025-07-17', '21:45:00'),
(10, '2025-07-17', '14:30:00'),
(10, '2025-07-17', '18:15:00'),
(10, '2025-07-17', '21:30:00'),
(11, '2025-07-17', '12:15:00'),
(11, '2025-07-17', '16:00:00'),
(11, '2025-07-17', '19:15:00'),
(12, '2025-07-17', '13:15:00'),
(12, '2025-07-17', '16:45:00'),
(12, '2025-07-17', '20:15:00'),
(13, '2025-07-17', '15:00:00'),
(13, '2025-07-17', '18:45:00'),
(13, '2025-07-17', '22:30:00'),
(14, '2025-07-17', '16:30:00'),
(14, '2025-07-17', '20:00:00'),
(14, '2025-07-17', '23:30:00'),
(15, '2025-07-17', '11:30:00'),
(15, '2025-07-17', '14:45:00'),
(15, '2025-07-17', '18:00:00'),

-- July 18, 2025 showtimes
(1, '2025-07-18', '13:00:00'),
(1, '2025-07-18', '16:30:00'),
(1, '2025-07-18', '20:00:00'),
(2, '2025-07-18', '14:15:00'),
(2, '2025-07-18', '17:45:00'),
(2, '2025-07-18', '21:15:00'),
(3, '2025-07-18', '12:30:00'),
(3, '2025-07-18', '15:45:00'),
(3, '2025-07-18', '19:00:00'),
(4, '2025-07-18', '13:30:00'),
(4, '2025-07-18', '17:00:00'),
(4, '2025-07-18', '20:30:00'),
(5, '2025-07-18', '14:00:00'),
(5, '2025-07-18', '18:00:00'),
(5, '2025-07-18', '22:00:00'),
(6, '2025-07-18', '12:00:00'),
(6, '2025-07-18', '15:30:00'),
(6, '2025-07-18', '19:30:00'),
(7, '2025-07-18', '16:00:00'),
(7, '2025-07-18', '19:45:00'),
(8, '2025-07-18', '13:45:00'),
(8, '2025-07-18', '17:15:00'),
(8, '2025-07-18', '20:45:00'),
(9, '2025-07-18', '15:15:00'),
(9, '2025-07-18', '18:30:00'),
(10, '2025-07-18', '14:30:00'),
(10, '2025-07-18', '18:15:00'),
(11, '2025-07-18', '12:15:00'),
(11, '2025-07-18', '16:00:00'),
(12, '2025-07-18', '13:15:00'),
(12, '2025-07-18', '16:45:00'),
(13, '2025-07-18', '15:00:00'),
(13, '2025-07-18', '18:45:00'),
(14, '2025-07-18', '16:30:00'),
(14, '2025-07-18', '20:00:00'),
(15, '2025-07-18', '11:30:00'),
(15, '2025-07-18', '14:45:00'),

-- July 19, 2025 showtimes
(1, '2025-07-19', '13:00:00'),
(1, '2025-07-19', '16:30:00'),
(1, '2025-07-19', '20:00:00'),
(2, '2025-07-19', '14:15:00'),
(2, '2025-07-19', '17:45:00'),
(3, '2025-07-19', '12:30:00'),
(3, '2025-07-19', '15:45:00'),
(3, '2025-07-19', '19:00:00'),
(4, '2025-07-19', '13:30:00'),
(4, '2025-07-19', '17:00:00'),
(5, '2025-07-19', '14:00:00'),
(5, '2025-07-19', '18:00:00'),
(6, '2025-07-19', '12:00:00'),
(6, '2025-07-19', '15:30:00'),
(6, '2025-07-19', '19:30:00'),
(7, '2025-07-19', '16:00:00'),
(7, '2025-07-19', '19:45:00'),
(8, '2025-07-19', '13:45:00'),
(8, '2025-07-19', '17:15:00'),
(9, '2025-07-19', '15:15:00'),
(9, '2025-07-19', '18:30:00'),
(10, '2025-07-19', '14:30:00'),
(10, '2025-07-19', '18:15:00'),
(11, '2025-07-19', '12:15:00'),
(11, '2025-07-19', '16:00:00'),
(12, '2025-07-19', '13:15:00'),
(12, '2025-07-19', '16:45:00'),
(13, '2025-07-19', '15:00:00'),
(13, '2025-07-19', '18:45:00'),
(14, '2025-07-19', '16:30:00'),
(14, '2025-07-19', '20:00:00'),
(15, '2025-07-19', '11:30:00'),
(15, '2025-07-19', '14:45:00');